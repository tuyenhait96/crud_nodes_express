<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body onload="document.transferForm.submit()">
    <!-- <form
      method="POST"
      name="transferForm"
      action="http://e2374d09.ngrok.io/transfer/create"
    >
      <input type="text" name="accountId" value="hacker213" />
      <input type="number" name="account" value="10000" />
    </form> -->
    <button>
      Pha cà phê
    </button>
    <br />
    <br />
    <div id="status"></div>
    <br />
    <br />
    <hr />
    <div id="result"></div>
    <script>
      const button = document.querySelector("button");
      let content = document.getElementById("status");
      let result = document.getElementById("result");

      function updateStatus(newStatus) {
        content.textContent = newStatus;
        // content.innerHTML = newStatus;
      }

      function updateResult(newResult) {
        result.textContent = newResult;
        // result.innerHTML = newResult;
      }

      button.addEventListener("click", function () {
        doIt();
      });

      function doIt() {
        updateStatus("Chuẩn bị pha cà phê...");
        updateResult("Đang pha cà phê...");
        result.style.color = "brown";
        result.style.fontSize = "20px";
        xaycaphe()
          .then(function (xayxong) {
            return vatsua(xayxong);
          })
          .then(function (vatsuaxong) {
            return phacaphe(vatsuaxong);
          })
          .then(function (caphephaxong) {
            return caphephaxong.result;
          })
          .then(function () {
            ketThuc();
          });
      }

      function xaycaphe() {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            updateStatus("Xây xong cà phê trong... 2 giây");
            resolve({ cafe: ["a", b] }); //dataresolve1
          }, 2000);
        });
      }

      function vatsua(dataresolve1) {
        const promise = new Promise((resolve, reject) => {
          setTimeout(() => {
            updateStatus("Đã lấy sữa và trộn với cà phê hết... 2 giây");
            resolve({ newData: dataresolve1.cafe[0] + " + sữa ông thọ" }); //dataresolve2
          }, 2000);
        });
        return promise;
      }

      function phacaphe(dataresolve2) {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            updateStatus("Đã cà phê tong... 2 giây");
            resolve({ result: dataresolve2.newData + "+ pha bằng phin!" });
            console.log("DONE");
          }, 3000);
        });
      }

      function ketThuc() {
        setTimeout(() => {
          console.log("Pha tiếp");
          updateResult("Pha xong, pha tiếp đê quỉ ....");
          result.style.color = "red";
          result.style.fontSize = "23px";
        }, 3000);
      }
    </script>
  </body>
</html>
